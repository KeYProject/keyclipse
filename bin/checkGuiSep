#!/bin/sh

# 
# Check for interlaced gui and core code.
#
# This is used in the efforts to disentangle GUI and CORE code.
#
# Output is of the form
#   referencedClassName : referencedByClass
#
# For instance:
#  javax.swing.BorderFactory:de.uka.ilkd.key.speclang.SLEnvInput
#
# guisep.jar contains code and sources
#
# @author mattias ulbrich
#

KEY=..

listName=`tempfile -p list_ -s .txt`
resultName=`tempfile -p result_ -s .txt`

dir=$KEY/system/binary

find $dir -name "*.class" ! -regex "$dir/de/uka/ilkd/key/gui/.*" ! -regex "$dir/de/uka/ilkd/key/util/install/.*" > $listName

java -DFULL=true -cp guisep.jar edu.kit.iti.depgraph.ReferencedClasses @$listName > $resultName

echo References to java gui classes:
grep "^javax.swing." $resultName

echo References to key gui classes:
grep "^de.uka.ilkd.key.gui." $resultName
