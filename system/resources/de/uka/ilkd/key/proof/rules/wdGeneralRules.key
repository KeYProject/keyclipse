// This file is part of KeY - Integrated Deductive Software Design
//
// Copyright (C) 2001-2011 Universitaet Karlsruhe (TH), Germany
//                         Universitaet Koblenz-Landau, Germany
//                         Chalmers University of Technology, Sweden
// Copyright (C) 2011-2013 Karlsruhe Institute of Technology, Germany
//                         Technical University Darmstadt, Germany
//                         Chalmers University of Technology, Sweden
//
// The KeY system is protected by the GNU General
// Public License. See LICENSE.TXT for details.
//

\schemaVariables {
	\formula f;
	\term any s, t;
	\term alpha u;
	\variables alpha v;
	\termlabel l;
}

\rules(wdChecks:on) {
	wd_Atomic_Formula {

		\find (
			WD( (f)<<l>> )
		)
		\varcond (
			\isAtomic(f),
			\not \hasLabel(l, undef)
		)
		\replacewith (
			true
		)
		\heuristics ( simplify )
	};

	wd_Atomic_Term {

		\find (
			wd( (t)<<l>> )
		)
		\varcond (
			\isAtomic(t),
			\not \hasLabel(l, undef)
		)
		\replacewith (
			true
		)
		\heuristics ( simplify )
	};

	wd_Undef_Formula {

		\find (
			WD( (f)<<l>> )
		)
		\varcond (
			\isAtomic(f),
			\hasLabel(l, undef)
		)
		\replacewith (
			false
		)
		\heuristics ( simplify )
	};

	wd_Undef_Term {

		\find (
			wd( (t)<<l>> )
		)
		\varcond (
			\isAtomic(t),
			\hasLabel(l, undef)
		)
		\replacewith (
			false
		)
		\heuristics ( simplify )
	};

	wd_Subst_Formula {

		\find (
			WD( {\subst v; u} f )
		)
		\replacewith (
			wd( u ) & {\subst v; u} WD( f )
		)
		\heuristics ( simplify )
	};

	wd_Subst_Term {

		\find (
			wd( {\subst v; u} t )
		)
		\replacewith (
			wd( u ) & {\subst v; u} wd( t )
		)
		\heuristics ( simplify )
	};

	wd_Type_Cast {

		\find (
			wd( alpha::cast(t) )
		)
		\replacewith (
			wd(t) & (alpha::instance(t) = TRUE)
		)
		\heuristics ( simplify )
	};

	wd_Type_ExactInstance {

		\find (
			wd( alpha::exactInstance(t) )
		)
		\replacewith (
			wd(t)
		)
		\heuristics ( simplify )
	};

	wd_Type_Instance {

		\find (
			wd( alpha::instance(t) )
		)
		\replacewith (
			wd(t)
		)
		\heuristics ( simplify )
	};

	wd_Pair {

		\find (
			wd( pair(s, t) )
		)
		\replacewith (
			wd(s) & wd(t)
		)
		\heuristics ( simplify )
	};

	wd_Type_Pred_Instance {

		\find (
			WD( alpha::contains(t) )
		)
		\replacewith (
			wd(t)
		)
		\heuristics ( simplify )
	};

	wd_Equality_Pred {

		\find (
			WD( (s = t) )
		)
		\replacewith (
			wd(s) & wd(t)
		)
		\heuristics ( simplify )
	};
}